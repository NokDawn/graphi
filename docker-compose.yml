version: '3'
networks:
  main:
services:
    traefik:
        image: "traefik:v2.4"
        container_name: "traefik"
        command: 
            - "--api.insecure=true"
            - "--providers.docker=true"
            - "--entrypoints.http.address=:80"
            - "--global.sendAnonymousUsage=false"
        ports:
            - "80:80"
            - "8080:8080"
        volumes: 
            - "/var/run/docker.sock:/var/run/docker.sock:ro"
  api:
    container_name: 'api.local.tgs.com'
    restart: unless-stopped
    build:
      context: .
      dockerfile: ./registry/api/development/Dockerfile
    volumes:
      - './:/opt/app-root/src:rw'
    ports:
      - 80
    environment:
      PORT: 80
      NODE_ENV: 'development'
      APP_ENV: 'development'
    command: 'npm run dev'
